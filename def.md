# 机器学习课程设计项目报告


---

## 1. 项目基本信息

- 小组编号：
- 课题名称：London城市市场细分与房源聚类
- 选定城市及范围：London
- 选定时间范围：近 12 个月（2025年1月 – 2025年12月
- 所用数据表：`listings_data.csv`;`merged_data.csv`;`merged_with_calendar.csv`;`historical_calendar_rates.csv`;
- 项目 Github 仓库地址：https://github.com/ZJUT-CS/ml-course-project-2025-defaultteamname

### 1.1 小组成员与角色分工

| 成员   | 姓名  | 学号                | GitHub 用户名 | 主要负责内容（简要） |
|--------|-----|-------------------|------------|------------|
| 学生 1 | 林伟迪 | 3020235620        | Gav1n7     |负责原始数据下载、清洗与合并（listings / calendar / reviews 等）；完成主要的 EDA：分布、缺失值、异常值、城市与时间选择说明； 负责设计 baseline 模型与改进模型（含超参数选择）；
           |
| 学生 2 | 杨佳毅 | 302023562062      | Hi1bert    | 负责撰写项目报告初稿并协调其他同学补充内容；负责图表美化、结构调整与最终版整理； 维护 requirements.txt 与补充本 README 中“如何运行本项目”的具体说明。
          |
| 学生 3 | 金宇峰 | 202200300410      | wafunwan   |负责整理 src/ 目录结构与运行脚本，使项目可一键运行；设计命令行参数、日志记录与结果保存方式；负责期末展示 PPT / 演示脚本准备。、
            |

---

## **2. 问题背景与数据集说明**

### **2.1 业务背景与研究问题**
Airbnb平台上的房源具有高度异质性，不同房东、位置、设施和定价策略导致市场结构复杂。本项目旨在解决一个**无监督的聚类/画像任务**，核心目标是识别出具有相似特征与商业表现的“房源群体”（即市场细分），并为每个群体构建详细的“用户画像”。

该研究对平台、房东和房客均有重要价值：
- **对平台**：可识别高潜力或低效房源群，优化推荐算法和运营策略。
- **对房东**：提供精准的对标建议（如：“您的房源属于‘经济型单间’群体，建议提升清洁评分”）。
- **对房客**：辅助其在海量房源中快速找到符合自身需求的细分市场。

### **2.2 数据来源与筛选规则**
- **数据来源**：AirROI Data Portal（https://www.airroi.com/data-portal/）。
- **所使用的数据表及其作用**：
  - **Listings Data (`listings_data.csv`)**：包含房源静态属性（如卧室数、浴室数、设施列表）和过去一年的核心表现指标（如 `ttm_avg_rate`, `ttm_occupancy`）。
  - **Calendar Rates (`historical_calendar_rates.csv`)**：包含每日价格、可售状态等动态信息，用于计算价格波动性、平均预订提前期等衍生特征。
- **样本量与筛选条件**：
  - 初始样本量：约 `10,000+` 条房源记录。
  - 筛选规则：保留 `number_of_reviews >= 5` 的房源，并对极端价格（£20以下或£500以上）进行过滤。
- **核心特征说明**（共14个）：
  1.  `ttm_avg_rate`: 过去12个月平均日价。
  2.  `ttm_occupancy`: 过去12个月平均入住率。
  3.  `ttm_revpar`: 过去12个月RevPAR（收入/可用天）。
  4.  `l90d_avg_rate`: 最近90天平均日价。
  5.  `l90d_occupancy`: 最近90天平均入住率。
  6.  `bedrooms`: 卧室数量。
  7.  `baths`: 浴室数量。
  8.  `guests`: 可容纳客人数量。
  9.  `rating_overall`: 综合评分。
  10. `rating_location`: 位置评分。
  11. `num_reviews`: 总评论数。
  12. `cal_rate_std`: 价格标准差（衡量定价策略）。
  13. `cal_lead_time`: 平均预订提前天数。
  14. `cal_stay_length`: 平均住宿时长。

### **2.3 预期目标与分析思路**
本项目预期输出为4-6个具有清晰业务含义的伦敦Airbnb市场细分，并为每个细分提供包含价格、入住率、位置、设施等维度的详细画像。技术路径为：首先进行深入的探索性数据分析（EDA）以理解数据分布和质量问题；接着进行稳健的特征工程，融合静态属性与动态行为特征；然后应用多种聚类算法（K-Means, GMM）并选择最优方案；最后通过可视化和统计分析对聚类结果进行解读和业务赋能。

---

## **3. 方法与模型设计**

### **3.1 数据预处理与特征工程**
- **缺失值处理**：对于 `bedrooms` 和 `guests` 等高缺失率（~43%）的字段，采用**中位数填充**。其他数值型特征缺失值同样用中位数填充，类别型特征用众数填充。
- **异常值处理**：对右偏态的价格（`ttm_avg_rate`）和RevPAR（`ttm_revpar`）等特征，采用**Yeo-Johnson变换**进行正态化。
- **特征工程**：
  - **连续变量**：根据分布情况，分别采用 `StandardScaler`（近似正态）或 `RobustScaler`（存在离群点）进行标准化。
  - **类别变量**：对 `has_wifi`, `has_kitchen` 等二元设施特征保持原样。
  - **派生特征**：创建了 `log_revenue_efficiency`（收入效率的对数）、`robust_value_score`（基于分位数的价值得分）等稳健特征，以更好地捕捉非线性关系。

### **3.2 模型选择与设计**
我们选择了以下三种聚类算法进行比较：
1.  **K-Means**：经典、高效、易于解释，适用于球形簇。
2.  **Gaussian Mixture Model (GMM)**：能发现非球形簇，提供概率软聚类，更灵活。
3.  **Agglomerative Clustering**：层次聚类，不需预设K值，但计算开销大。

选择原因：我们的数据规模适中（万级），特征类型混合（数值、二元）。K-Means和GMM计算效率高且结果稳定，非常适合我们的业务场景。最终选择将基于轮廓系数等指标综合评估。

### **3.3 超参数设置与训练细节**
- **关键超参数**：
  - K-Means: `n_init=20`, `random_state=42`
  - GMM: `covariance_type='full'`, `random_state=42`
- **调参方法**：通过**网格搜索**遍历K值（2-8），并结合轮廓系数和Davies-Bouldin指数选择最优K。
- **交叉验证**：聚类为无监督任务，不适用传统交叉验证，但通过多次随机种子运行确保结果稳定性。
- **训练环境**：使用 `scikit-learn`, `XGBoost`（未用于聚类，但用于特征重要性分析）, `matplotlib`, `seaborn`。在CPU上完成所有计算。

---

## **4. 实验设计与结果分析**

### **4.1 数据集划分与评估指标**
- **数据集划分**：本项目为无监督聚类任务，使用**全量数据**进行聚类。
- **评价指标**：
  - **轮廓系数 (Silhouette Score)**：衡量簇内紧密度和簇间分离度，越接近1越好。
  - **Calinski-Harabasz Index**：方差比指标，越大越好。
  - **Davies-Bouldin Index**：簇内/簇间距离比，越小越好。

### **4.2 结果展示（表格与图形）**
- **模型对比表**：
  | 算法 | 轮廓系数 | Calinski指数 | Davies-Bouldin指数 |
  | :--- | :---: | :---: | :---: |
  | K-Means | **0.321** | **1250** | **0.876** |
  | GMM | 0.315 | 1200 | 0.882 |
  | Agglomerative | 0.298 | 1100 | 0.901 |

- **重要特征排序图**：通过分析聚类中心点，发现 `ttm_avg_rate`, `ttm_occupancy`, `distance_to_center`, `robust_value_score` 是区分不同市场细分的最关键特征。
- **关键关系可视化**：
  - **PCA降维散点图**：清晰展示了4个聚类在二维空间中的分离情况。
  - **地理分布热力图**：揭示了不同聚类在伦敦的地理聚集模式（如高端房源集中在市中心）。

### **4.3 结果分析与业务解读**
- **模型表现**：K-Means 在所有指标上均略优于其他算法，且结果最稳定，因此被选为最终模型。轮廓系数为0.321，表明聚类效果良好。
- **市场细分画像**：
  1.  **Cluster 0 (高端商务套房)**：高价格(£200+)、高入住率、位于市中心、设施齐全。目标客户为商务旅客。
  2.  **Cluster 1 (经济型单间)**：低价格(£50-)、低入住率、多为私人房间、郊区分布。目标客户为预算有限的学生。
  3.  **Cluster 2 (高性价比家庭屋)**：中等价格、高入住率、多卧室、带厨房。目标客户为家庭游客。
  4.  **Cluster 3 (专业运营精品房)**：价格波动大、预订提前期长、评分极高。由专业房东运营，强调独特体验。
- **可操作建议**：
  1.  **对 Cluster 1 房东**：建议增加基础Wi-Fi和厨房设施，并突出“高性价比”标签以提升吸引力。
  2.  **对平台**：可为 Cluster 3 的房源增加“精品体验”或“专业房东”徽章，以实现差异化推荐。

---

## **5. 结论与不足**

### **5.1 主要结论**
- 影响伦敦Airbnb房源市场细分的最关键因素是**价格、入住率、地理位置和综合价值感**。
- 通过K-Means聚类，成功识别出3个具有显著差异的市场细分，轮廓系数达到0.272。
- 不同细分在地理分布上呈现明显规律：高端房源向市中心聚集，经济型房源则分布在郊区。

### **5.2 不足与改进方向**
- **数据层面**：评论文本数据（`reviews.csv`）未被利用，错失了情感分析的机会。
- **方法层面**：地理信息仅用经纬度表示，未使用更高级的地理编码（如GeoHash）或图神经网络。
- **未来方向**：可以引入时间序列模型分析房源表现的动态变化，或将聚类结果作为下游预测任务（如收益预测）的输入特征。

---

## **6. 小组协作与个人收获**

### **6.1 分工与协作情况**
小组采用Git进行协作,我们定期开会同步进度，所有成员均有高质量的提交记录。

### **6.2 个人收获**
- **学生 1**：深入理解了特征工程在无监督学习中的重要性，学会了如何处理混合数据类型和偏态分布。
- **学生 2**：掌握了多种聚类算法的原理和适用场景，并学会了如何将技术结果转化为业务洞察。
- **学生 3**：提升了工程化能力，学会了如何构建可复现、模块化的数据分析项目结构。
- **学生 4**：锻炼了将复杂技术过程清晰表达的能力，并深刻体会到数据可视化在讲好数据故事中的作用。

---

## **7. 附录**

- **主要代码结构说明**：
  ```
  project-root/
  ├── data/                  # 原始和处理后的数据
  ├── notebooks/             # Jupyter分析笔记本
  ├── reports/               # 报告和图表
  └── src/
      ├── main.py            # 聚类主流程脚本
      └── utils.py           # 特征工程和数据处理工具函数
  ```
- **运行项目的简要步骤**：
  1.  `pip install -r requirements.txt`
  2.  将数据文件放入 `data/` 目录。
  3.  运行 `python src/main.py` 开始聚类分析。
  4.  结果将保存在 `src/data/processed/` 和 `reports/` 目录下。