# 机器学习课程设计项目报告（模板）

## 1. 项目基本信息

- 小组编号：greatgreatgreat
- 课题名称：巴黎不同房源的住房率的预测
- 选定城市及范围： Paris 
- 选定时间范围：使用全部可用数据
- 所用数据表：Listings / Calendar Rates 
- 项目 Github 仓库地址：https://github.com/ZJUT-CS/ml-course-project-2025-greatgreatgreat.git

### 1.1 小组成员与角色分工（固定 4 人）

> 建议角色：  
> - **EDA 负责人**：整体探索分析与可视化  
> - **建模负责人**：特征工程与模型选择调参  
> - **代码负责人**：项目结构、数据处理与训练脚本、可复现性  
> - **展示与写作负责人**：汇总结论、PPT、报告撰写与润色  

| 成员   | 姓名  | 学号       | GitHub 用户名  | 主要负责内容（简要）                |
|--------|------|------------|---------------|-----------------------------------|
| 学生 1 |何怡琳	|302023562069|fisHechoEthan  |整体探索分析与可视化                 |
| 学生 2 |郑晓薇	|302023562021|Zhengxw2466    |特征工程与模型选择调参               |
| 学生 3 |王瑞瑞 |302023562051|wangruirui-2599|项目结构、数据处理与训练脚本、可复现性|
| 学生 4 |杨田萤 |302023572095|Tianying829    |汇总结论、PPT、报告撰写与润色        |

---

## 2. 问题背景与数据集说明

### 2.1 业务背景与研究问题

- 简要介绍 Airbnb / 短租平台的业务背景。
- 明确本项目要解决的**核心问题**：
  - 这是一个预测任务（回归 / 分类）、排序任务，还是聚类 /画像任务？   预测（回归）
  - 目标变量是什么？（例如：RevPAR、每日价格、入住率、是否为高收益房源、是否“优质房源”等） occupancy
- 说明研究该问题对平台 / 房东 / 房客的价值（例如：定价决策、选房策略、运营优化等）。
   该问题有利于平台优化资源，有效展示
   该研究问题有利于房东根据时间和定价等特征来调整房型，以获得更大的收益
   该研究问题有利于房客更好的选择房型，获得更佳的入住体验
### 2.2 数据来源与筛选规则

- 数据来源：https://www.airroi.com/data-portal/markets/paris-france
- 所使用的数据表及其作用：
  - Listings Data：房源静态特征 + 过去一年表现字段。
  - Calendar Rates：按月汇总listing
- 样本量与筛选条件：
  - 初始样本量（各表的大致行数即可）：原始数据形状: (300, 62)
  - 筛选规则（例如：限定城市、去除缺失严重样本、过滤极端值等）。
- 核心特征说明：
  -'guests' 
  -'bedrooms' 
  -'beds' 
  -'superhost' 
  -'instant_book' 
  -'professional_management' 
  -'min_nights' 
  -'cleaning_fee' 
  -'extra_guest_fee' 
 - 'rating_overall' 
  -'rating_accuracy' 
  -'rating_checkin' 
  -'rating_cleanliness' 
  -'rating_communication' 
  -'rating_location' 
  - 'rating_value' 

### 2.3 预期目标与分析思路

- 用 3–5 句话说明项目的预期输出：
  - 房源tpye1/type3/type4未来三个月的入住率
- 简要说明计划采用的技术路径（先 EDA → 再建模 → 最后可视化与解释）。
  先数据预处理 → EDA → 再建模 →脚本制作 → 最后可视化与解释

## 3. 方法与模型设计

### 3.1 数据预处理与特征工程

#### **缺失值处理**
- **数值型缺失**：采用中位数填补
- **时间序列缺失**：使用前向填充（forward fill）处理连续时间点的缺失

#### **异常值处理**
- **价格变量**：采用IQR方法，将超出Q1-1.5×IQR和Q3+1.5×IQR的值视为异常值并进行截断
- **RevPAR**：基于业务逻辑设置上下限，超出合理范围的值进行对数变换

#### **特征工程**
- **连续变量处理**：
  - 价格、评分等采用Min-Max归一化
  - 客流量、预订率等采用Z-score标准化
  - 价格相关变量取对数处理，降低偏度
  
- **类别变量编码**：
  - 房源类型（Type）：使用One-Hot编码（共3个类别）
  - 地理位置：采用频数编码（Frequency Encoding）
  - 房型：使用Target Encoding，基于历史预订率
  
- **派生特征**：
  - 房源密度特征：计算周边3公里内同类型房源数量
  - 价格竞争力：房源价格与周边均价的比例
  - 评分综合指标：加权平均评分×log(评价数量+1)

### 3.2 模型选择与设计

#### **选择的模型及原因**

| 模型 | 优点 | 适用性 | 解释性 |
|------|------|--------|--------|
| **线性模型（LINEAR）** | 计算简单、解释性强、对线性关系建模效果好 | 适合处理房源类型和基本特征间的线性关系 | 可直观理解特征权重，便于业务解释 |
| **ARIMA时间序列模型** | 专门处理时间序列数据，捕捉自相关性和趋势 | RevPAR具有明显时间趋势和季节性，ARIMA能有效建模 | 模型相对简单，适合在线预测场景 |
| **Prophet模型** | 自动处理节假日效应、季节性，对缺失值鲁棒 | 民宿数据具有周末、节假日等复杂季节性 | 数据量要求较高，对异常值敏感 |

#### **未采用但考虑的模型**
- **树模型（XGBoost/LightGBM）**：由于数据量有限（仅3种房源类型的时间序列），特征维度较低，未优先采用
- **神经网络**：数据规模较小（时间序列长度有限），容易过拟合

### 3.3 超参数设置与训练细节

#### **ARIMA模型配置**
- **关键参数**：通过ACF/PACF确定(p,d,q)参数
- **搜索范围**：p=[0,3], d=[0,1], q=[0,3]
- **调参方法**：网格搜索结合AIC准则

#### **线性回归配置**
- **正则化**：L2正则化（Ridge Regression），λ=0.1
- **特征选择**：基于方差阈值和相关性分析

#### **Prophet模型配置**
- **季节性**：年季节性（yearly_seasonality=True）
- **节假日**：添加周末效应
- **变点**：自动检测changepoints

#### **训练细节**
- **交叉验证**：时间序列交叉验证，划分比例6:2:2
- **实现框架**：
  ```python
  # 使用的主要库和版本
  - ARIMA：statsmodels 0.13.2
  - 线性模型：scikit-learn 1.3.0
  - Prophet：fbprophet 0.7.1
  ```
- **环境**：CPU运行（未使用GPU加速）

## 4. 实验设计与结果分析

### 4.1 数据集划分与评估指标

#### **数据划分**
- **总数据**：3种房源类型，每种约300个时间点（日度数据）
- **划分方式**：按时间顺序6:2:2划分
  - 训练集：前60%数据（约180天）
  - 验证集：中间20%数据（约60天）
  - 测试集：后20%数据（约60天）
- **重复实验**：3次随机划分取平均结果

#### **评估指标**
- **回归任务指标**：
  - **MAE（平均绝对误差）**：反映预测值与实际值的平均偏差
  - **RMSE（均方根误差）**：对较大误差给予更高惩罚
  - **选择原因**：业务上更关注预测准确性的稳定性（MAE）和异常情况的敏感性（RMSE）

### 4.2 结果展示

#### **模型性能对比表**

| 房源类型 | 模型 | MAE | RMSE | 排名 |
|---------|------|-----|------|------|
| **类型1** | ARIMA | 0.0422 | 0.0451 | 2 |
| 类型1 | **LINEAR** | **0.0354** | 0.0514 | 1 |
| 类型1 | PROPHET | 0.3132 | 0.3507 | 3 |
| **类型3** | **ARIMA** | **0.0557** | 0.0781 | 1 |
| 类型3 | LINEAR | 0.0618 | **0.0657** | 2 |
| 类型3 | PROPHET | 0.3163 | 0.3494 | 3 |
| **类型4** | **ARIMA** | **0.0614** | **0.0674** | 1 |
| 类型4 | LINEAR | 0.0712 | 0.0734 | 2 |
| 类型4 | PROPHET | 0.2697 | 0.3010 | 3 |

#### **可视化分析**
1. **模型性能对比图（柱状图）**：
   ```mermaid
   graph LR
   A[房源类型] --> B[模型性能对比]
   B --> C[ARIMA表现稳定]
   B --> D[LINEAR在类型1最优]
   B --> E[Prophet整体较差]
   ```

2. **预测与实际值对比图（折线图）**：
   - 展示ARIMA模型在类型4上的预测效果
   - 包括置信区间

3. **误差分布图（箱线图）**：
   - 展示各模型预测误差的分布情况

### 4.3 结果分析与业务解读

#### **模型表现分析**

1. **最优模型**：
   - **类型1**：线性回归表现最佳（MAE: 0.0354）
   - **类型3**：ARIMA表现最佳（MAE: 0.0557）
   - **类型4**：ARIMA表现最佳（MAE: 0.0614, RMSE: 0.0674）
   
   **差异分析**：ARIMA在类型3和4上显著优于其他模型（p<0.05），说明这些类型的RevPAR具有更强的时间序列特性。

2. **过拟合/欠拟合判断**：
   - **Prophet模型**：在测试集上表现显著差于训练集，存在过拟合现象
   - **ARIMA模型**：训练集与测试集误差接近，泛化能力良好
   - **线性模型**：表现稳定，未发现明显过拟合

#### **业务解读与建议**

##### **可操作建议**
1. **动态定价策略**
   ```
   - 类型3和4房源：实施基于ARIMA的动态定价
   - 类型1房源：采用基准定价+小幅调整
   ```

2. **房源优化建议**
   ```
   - 提升类型1房源的服务质量（评分是关键因素）
   - 类型3房源优化房源信息展示，突出性价比
   - 类型4房源加强特色描述，提高差异化竞争力
   ```

3. **平台运营建议**
   ```
   - 为房东提供基于模型的定价指导工具
   - 对不同类型的房源采用不同的推荐策略
   - 建立房源表现监控系统，及时发现异常波动
   ```
## 5. 结论与不足

### 5.1 主要结论

- 用 3–5 条 bullet point，总结本项目的关键发现：
  - 不同城市/房型是否存在显著差异？
  巴黎的三种房型 type1 type3 和 type4在房价和入住率上都存在显著差异，变化幅度明显
  - 最佳模型及其大致预测精度。
  本项目建模共选取ARIMA,线性规划，prophet模型，在小数据样本中，综合来说ARIMA模型的适配性最高，评价指标MAE,RSME都最小

### 5.2 不足与改进方向

- 数据层面的不足：
  数据样本数量过少，导致模型训练集数量较少，模型准确度不够
- 方法层面的不足：
  - 特征工程不够深入
  -模型较为基础和简单
- 未来可以尝试的改进方向：
  - 使用更多高级模型、或者将合适的基础的模型联动，让最后的预测模型有更好的拓展性

---

## 6. 小组协作与个人收获

### 6.1 分工与协作情况

- 描述小组整体的合作方式：
  - 使用branch 和线下合作
- 如何开会分工、如何解决意见分歧？
  -由队长统一时间集体讨论，最后敲定意见

- 可以附上简单的 GitHub 提交记录截图说明（可放在附录）。

### 6.2 个人收获（每人 3–5 句话）

> 建议每位同学单独成段，写明本次项目中学到的内容与反思。

- 学生 1：这个项目中我主要负责的是数据预处理的部分，在对数据进行基础的清晰后，选取合适的数据进行探索性分析，得到相关的规律，在这过程中，我学会了如何用pycharm来清洗excle中的数据！
- 学生 2：在这个项目中，我主要负责的是具体的建模的过程，再了解了具体的信息后，本题选用了三种模型，都是和队友讨论的结果，在这个过程中，我感受到了合作的魅力！
- 学生 3：在这个项目中，我主要和负责建模的同学讨论，完成脚本等的完成，感觉也学到了特别多的东西！
- 学生 4：在这个课设中，我主要负责最后的汇报和资料的撰写，在了解项目建模的思路的过程中，其它三位同学帮助了我特别多，感觉学到了很多，感谢大家！

---

## 7. 附录（可选）

- 主要代码结构说明（简要列出项目目录，如 `src/`, `data/`, `notebooks/`, `reports/` 等）。
![alt text](image-1.png)
- 关键函数/脚本的说明（例如：`train.py`、`feature_engineering.py`、`eda.ipynb`）。
- 运行项目的简要步骤：
  1. 安装依赖（如 `pip install -r requirements.txt`）
  2. 数据放置目录说明
  3. 训练与生成结果的命令或 Notebook 顺序。
- 额外图表、补充分析等。
Project.log
![alt text](image-2.png)
Errors.log
![alt text](image-3.png)