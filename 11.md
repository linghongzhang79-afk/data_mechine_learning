# 机器学习课程设计项目报告

## （巴黎 Airbnb 房源市场细分与聚类画像）

### 1. 项目基本信息

小组编号：11

课题名称：巴黎 Airbnb 房源市场细分与核心客群聚类画像

选定城市及范围：Paris（巴黎）

选定时间范围：使用全部可用数据（涵盖近 12 个月房源表现数据）

所用数据表：Listings（核心数据表）

项目 Github 仓库地址：<https://github.com/ZJUT-CS/ml-course-project-2025-11>

### 2. 小组成员与角色分工

| 成员 | 姓名 | 学号 | GitHub 用户名 | 主要负责内容（简要） |
| :--- | :--- | :--- | :--- | :--- |
| 学生 1 | 杨妹 | 302023562044 | Ymy1002 | 建立模型、分析、整合代码、报告、PPT |
| 学生 2 | 吴生蓉 | 302023562048 | wushengrong523 | 清洗数据、分析、整合代码、报告、PPT |

### 3. 问题背景与数据集说明

#### 3.1 业务背景与研究问题

Airbnb 作为全球领先的短租平台，连接了海量房东与出行旅客，巴黎作为国际旅游与商务核心城市，其房源供给呈现高度异质性。不同房源在户型、价格、地理位置、运营表现上存在显著差异，房东难以精准定位自身房源的市场定位，平台也无法实现高效的供需匹配。

本项目属于聚类 / 画像任务，无明确目标变量，核心问题是：通过无监督聚类算法，将巴黎 Airbnb 房源划分为具有业务辨识度的细分市场，并提炼各细分市场的核心特征与客群画像。

研究该问题的价值：

-   对房东：明确自身房源所属细分市场，针对性制定定价、装修、运营策略，提升房源收益与入住率；
-   对平台：基于细分市场实现精准房源推荐，提升旅客匹配效率与用户满意度，增强平台粘性；
-   对房客：快速找到符合自身需求（价格、户型、位置）的房源，优化出行住宿体验。

#### 3.2 数据来源与筛选规则

数据来源：AirROI Data Portal（URL：<https://www.airroi.com/data-portal/>）

所使用的数据表及其作用：

Listings Data：提供房源静态属性（房型、卧室数、设施等）、近 12 个月表现数据（均价、入住率、RevPAR 等）、口碑数据（评分、评论数）及地理位置数据（经纬度），是本项目的核心数据支撑。

样本量与筛选条件：

初始样本量：Listings 数据表共 300条巴黎房源记录；

筛选规则：

1.  剔除缺失值占比超过 50% 的特征；
2.  对数值特征用中位数填充缺失值，类别特征用众数填充缺失值，特殊字段 `amenities` 填空字符串；
3.  未过滤极端值

核心特征说明（12 个关键字段）：

| 字段名称 | 字段含义 | 预期影响 |
| :--- | :--- | :--- |
| room_type | 房间类型（整租 / 私人单间等） | 决定房源定位，整租房源多面向家庭 / 团队，单间多面向单人旅客 |
| guests | 可容纳人数 | 反映房源规模，人数越多越适合家庭出行，价格通常越高 |
| bedrooms | 卧室数 | 体现房源户型大小，卧室数越多，客单价与目标客群层级越高 |
| ttm_avg_rate | 近 12 月均价 | 核心价格指标，直接决定房源市场定位与收益水平 |
| ttm_occupancy | 近 12 月入住率 | 反映房源受欢迎程度，入住率越高，运营表现越稳健 |
| ttm_revpar | 近 12 月每间可售房收入 | 综合收益指标，体现房源盈利能力 |
| rating_overall | 总体评分 | 反映房源口碑，评分越高，越易获得旅客青睐，复购率更高 |
| rating_location | 位置评分 | 体现房源地理位置优劣，评分越高，交通与出行便捷性越强 |
| num_reviews | 评论数 | 侧面反映房源运营时长与受欢迎程度，评论数越多，可信度越高 |
| amenities | 设施列表 | 设施越齐全，旅客体验越好，房源竞争力越强 |
| latitude | 纬度 | 地理位置坐标，用于可视化房源空间分布，判断核心 / 郊区区域 |
| longitude | 经度 | 地理位置坐标，与纬度配合实现地图可视化 |

#### 3.3 预期目标与分析思路

本项目预期输出：

完成巴黎 Airbnb 房源的特征预处理与聚类建模，确定最优聚类数量，得到 3 个具有显著差异的房源细分市场；

生成各细分市场的关键特征统计表格、价格 / 户型差异可视化图表、巴黎房源地理位置聚类地图；

提炼各细分市场的业务画像与可理解名称，为房东与平台提供可操作的运营建议。

技术路径：

先进行探索性数据分析（EDA），了解数据分布、缺失值情况与特征相关性；

再开展特征工程与预处理，包括缺失值填充、设施字段简化、类别特征编码与数值特征标准化；

随后搭建 KMeans 与 GMM 两种聚类模型，通过轮廓系数选择最优聚类数，完成建模与模型对比；

最后对聚类结果进行可视化分析，撰写业务画像，汇总结论与运营建议。

### 4. 方法与模型设计

#### 4.1 数据预处理与特征工程

缺失值处理方式：

-   数值型特征（`guests`, `bedrooms`, `ttm_avg_rate` 等）：采用中位数填充，抗极端值影响，符合聚类任务对数据分布的要求；
-   类别型特征（`room_type`, `instant_book` 等）：采用众数填充，保证填充值符合数据的主流分布；
-   特殊字段（`amenities`）：填充为空字符串，后续通过解析提取关键设施特征，避免信息丢失。

异常值处理：

未对价格、RevPAR 等字段进行截断或变换，原因如下：

1.  极端高价房源属于高端细分市场，具有重要业务分析价值；
2.  KMeans 算法通过距离聚类，轻微极端值不会对整体聚类结果产生决定性影响，且最终聚类结果中极端值已形成独立细分市场，符合业务逻辑。

特征工程：

-   连续变量：对 `guests`、`bedrooms`、`ttm_avg_rate` 等数值特征进行 Z-Score 标准化（均值为 0，标准差为 1），消除量纲差异对聚类算法的影响，确保各特征权重一致；
-   类别变量：对 `room_type`、`instant_book` 等类别特征采用 One-Hot 编码（`drop_first=True`），避免类别顺序带来的虚假相关性，同时减少特征维度；
-   派生特征：对 `amenities` 字段进行解析，派生得到 `has_wifi`、`has_kitchen`、`has_washer` 3 个布尔特征（是否具备对应设施），以及 `total_amenities`（总设施数量）特征，简化高维设施字段，提升聚类效果。

#### 4.2 模型选择与设计

本项目选用两种无监督聚类模型，分别为 KMeans 与高斯混合模型（GMM），选择原因如下：

**模型列表与适用性分析**

KMeans 聚类模型：

-   优点：算法简单高效，计算成本低，易于理解与实现，对中等规模数据（299 条样本）适配性强，聚类结果可解释性好，便于后续业务画像撰写；
-   缺点：对初始聚类中心敏感，对非球形分布数据聚类效果不佳；
-   适用性：本项目数据经过标准化后，各特征分布相对均匀，且房源细分市场具有明显的 "球形分布" 特征（如价格、户型的集中分布），适合使用 KMeans 模型。

高斯混合模型（GMM）：

-   优点：属于概率型聚类模型，假设数据服从高斯分布，可捕捉非球形分布的数据结构，聚类结果更灵活，能给出样本属于各聚类的概率，提升结果的可靠性；
-   缺点：计算复杂度高于 KMeans，对初始参数敏感，样本量较小时可能出现过拟合；
-   适用性：作为 KMeans 模型的补充，用于验证聚类结果的稳健性，对比两种模型的轮廓系数，确保细分市场划分的合理性，同时满足课程 "至少使用两种及以上模型" 的要求。

模型对比：

| 模型名称 | 优点 | 缺点 | 易用性 | 可解释性 | 部署难度 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| KMeans | 简单高效、计算成本低 | 对初始中心敏感、不适用于非球形数据 | 高 | 高 | 低 |
| GMM | 灵活捕捉非球形分布、给出概率结果 | 计算复杂、样本量小易过拟合 | 中 | 中 | 中 |

#### 4.3 超参数设置与训练细节

**各模型的关键超参数**

KMeans 模型：

-   `n_clusters`：聚类数量，通过遍历 2-10 的取值，结合轮廓系数确定最优值为 3；
-   `random_state`：随机种子，设置为 42，保证结果可复现；
-   `n_init`：初始化次数，设置为 "auto"，自动选择最优初始化策略；
-   （注：未设置 `n_jobs` 参数，使用模型默认配置，保持原始代码逻辑）

GMM 模型：

-   `n_components`：聚类数量，与 KMeans 最优聚类数保持一致，为 3；
-   `random_state`：随机种子，设置为 42，保证结果可复现；
-   `covariance_type`：协方差矩阵类型，设置为 "full"，使用全协方差矩阵，提升模型拟合效果。

调参方法：

-   聚类数调参：采用手动遍历 + 指标评估的方式，遍历 k=2, 3…10 的取值，计算每个 k 值对应的轮廓系数，选择轮廓系数最大的 k=3 作为最优聚类数；
-   其他超参数：采用默认值或经验值，因样本量较小（299 条），无需进行网格搜索或随机搜索，手动设置关键参数即可满足需求；
-   交叉验证：未采用传统 k 折交叉验证，聚类任务通过轮廓系数、样本分布合理性、业务可解释性进行综合验证，确保结果可靠。

训练环境与实现说明：

-   使用框架：scikit-learn（核心框架，用于数据预处理、聚类建模与指标计算）、pandas（数据读取与处理）、numpy（数值计算）、matplotlib/folium（数据可视化）；
-   硬件环境：CPU 训练（Intel Core i5/i7），无需 GPU，数据量较小，训练时长小于 1 分钟；
-   操作系统：Windows 10/11（使用模型默认配置，无需额外调整并行参数）。

### 5. 实验设计与结果分析

#### 5.1 数据集划分与评估指标

数据集划分与评估指标：

本项目为聚类任务，无监督学习无需划分训练 / 验证 / 测试集，仅使用全量数据进行聚类建模，原因如下：

-   样本量较小（300条），划分后会导致各子集样本量不足，影响聚类效果；
-   聚类任务的核心是发现数据的内在结构，而非预测未知数据，全量数据建模更能反映巴黎房源的整体市场分布。

评价指标：

-   轮廓系数（Silhouette Score）：核心定量指标，取值范围为 [-1,1]，越接近 1 表示聚类效果越好，类内相似度高，类间差异大；本项目中 KMeans 模型（k=3）的轮廓系数为 0.3039，GMM 模型（k=3）的轮廓系数略低于 KMeans，验证了 KMeans 模型的有效性；
-   定性指标：
    1.  样本分布合理性，各聚类样本数量避免极端不均衡（聚类 0:249 条、聚类 1:49 条、聚类 2:2 条，聚类 2 样本量极少为特殊长尾房源）；
    2.  业务可解释性，聚类结果能够对应不同的房源细分市场，符合 Airbnb 的业务逻辑。

#### 5.2 结果展示

1.  **聚类关键特征统计表格**

表 1 KMeans 各聚类关键特征统计（k=3）

| 聚类 ID | 样本数 | 平均可容纳人数 | 平均卧室数 | 平均浴室数 | 中位数最小入住晚数 | 近12月均价（欧元） | 近12月入住率 | 近12月 RevPAR（欧元） | 总体评分 | 平均评论数 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 0 | 249 | 2.74 | 1.19 | 0.93 | 2 | 165.93 | 36% | 56.80 | 4.74 | 164.20 |
| 1 | 49 | 5.41 | 2.69 | 1.69 | 3 | 481.04 | 44% | 197.84 | 4.87 | 176.53 |
| 2 | 2 | 2.00 | 1.00 | 1.00 | 2 | 124.30 | 11% | 15.75 | 3.88 | 120.00 |

表 2 各聚类房间类型分布（%）

| 聚类 ID | Entire home/apt（整租） | Private room（私人单间） | Shared room（共享房间） |
| :--- | :--- | :--- | :--- |
| 0 | 86.35 | 13.25 | 0.40 |
| 1 | 100.00 | 0.00 | 0.00 |
| 2 | 50.00 | 50.00 | 0.00 |

2.  **关键可视化图形**

-   KMeans 聚类：轮廓系数与聚类数 k 的关系k=3 时轮廓系数达到最大值 0.3039，为最优聚类数，说明该聚类数量下类内相似度最高、类间差异最大。
    ![](media/image1.png)
    ![](media/image2.png)
-   各聚类的近 12 月均价分布箱线图（图注：聚类 1 均价显著高于聚类 0 与聚类 2，聚类 0 均价适中，聚类 2 均价最低，三者价格差异明显，验证了细分市场的价格分层逻辑）
    ![](media/image3.png)
-   图 4 巴黎房源聚类地理位置地图（HTML 交互图）（图注：聚类 0（蓝色）与聚类 1（绿色）集中分布在巴黎核心区域（塞纳河沿岸、埃菲尔铁塔周边），聚类 2（红色）样本量极少，分布无明显规律，直观反映了主流房源的空间分布特征）
    ![](media/image4.png)

#### 5.3 结果分析与业务解读

1)  **模型表现分析**

-   模型效果对比：KMeans 模型的轮廓系数（0.3039）高于 GMM 模型，聚类结果的样本分布更合理，业务可解释性更强，因此 KMeans 模型为本次项目的最优模型；
-   聚类效果验证：各聚类在价格、户型、入住率等核心特征上存在显著差异，无 "所有聚类特征分布接近" 的情况，仅聚类 2 样本量极少（2 条），属于长尾特殊房源，非噪声点，符合业务实际；
-   过拟合 / 欠拟合判断：无过拟合或欠拟合现象，聚类结果既捕捉了数据的内在结构，又未过度拟合局部异常值，且与业务认知高度一致，验证了模型的有效性。

2)  **业务解读与运营建议**

**各细分市场核心画像：**

-   **聚类 0：标准舒适型公寓 (Cluster 0, 252套房源, 84.0%)**
    -   核心特征：
        -   价格水平: €165/晚 (排名第3)
        -   收益表现: RevPAR €60, 入住率 36.9%
        -   房源规模: 适合2.7人, 1.2卧0.9卫
        -   质量评分: 总体4.74, 清洁度4.66, 位置4.82
        -   地理位置: 平均距市中心3.0km
    -   目标客群：满足大多数游客需求的标准房源，各方面表现均衡
-   **聚类 1：家庭度假大户型 (Cluster 1, 46套房源, 15.3%)**
    -   核心特征：
        -   价格水平: €501/晚 (排名第1)
        -   收益表现: RevPAR €191, 入住率 38.2%
        -   房源规模: 适合5.7人, 2.7卧1.7卫
        -   质量评分: 总体4.84, 清洁度4.73, 位置4.86
        -   地理位置: 平均距市中心3.2km
    -   目标客群：适合家庭出游，空间宽敞，设施家庭友好，多位于旅游区附近
-   **聚类 2：标准舒适型公寓 (Cluster 2, 2套房源, 0.7%)**
    -   核心特征：
        -   价格水平: €289/晚 (排名第2)
        -   收益表现: RevPAR €28, 入住率 9.7%
        -   房源规模: 适合4.0人, 1.5卧0.5卫
        -   质量评分: 总体nan, 清洁度nan, 位置nan
        -   地理位置: 平均距市中心3.8km
    -   目标客群：满足大多数游客需求的标准房源，各方面表现均衡

3)  **可操作建议**

**对房东的建议：**

-   聚类 0 房源房东：提升标准化服务水平，优化房源描述和照片质量，收集并响应住客反馈，持续改进。
-   聚类 1 房源房东：增加儿童设施（婴儿床、高椅、安全门），提供家庭活动推荐和景点门票优惠，淡季推出家庭特惠套餐。
-   聚类 2 房源房东：提升标准化服务水平，优化房源描述和照片质量，收集并响应住客反馈，持续改进。

**对平台的建议：**

-   精准推荐优化：针对旅游人群优先推荐聚类 0 房源，针对家庭 / 商务客群优先推荐聚类 1 房源，针对价格敏感型单人旅客推荐聚类 0 中的私人单间房源，提升供需匹配效率；
-   运营资源倾斜：为聚类 0 与聚类 1 的主流房源提供更多曝光机会，对聚类 2 的低活跃房源进行房东运营指导，提升平台整体房源质量与用户满意度。

### 6. 结论与不足

#### 6.1 主要结论

1.  巴黎 Airbnb 房源可划分为 3 个差异化细分市场，分别为中等价位旅游短住型、高端家庭 / 商务型、小众低活跃型，其中前两者为核心主流市场，覆盖 99.3% 的房源；
2.  房源的价格、户型（可容纳人数、卧室数）与地理位置是决定市场细分的核心因素，整租房源在巴黎市场占据主导地位（聚类 0+1 整租占比达 88.6%）；
3.  KMeans 模型在本次聚类任务中表现更优（轮廓系数 0.3039），聚类结果具有较强的业务可解释性，可为房东与平台提供切实可行的运营指导；
4.  巴黎核心区域是房源的主要分布地，核心区域房源的评分与入住率普遍高于非核心区域，地理位置对房源运营表现具有重要影响；
5.  高端大户型房源（聚类 1）虽样本量较少，但单晚均价与 RevPAR 显著高于其他市场，是平台与房东的高价值细分市场。

#### 6.2 不足与改进方向

**数据层面的不足：**

1.  样本量较小：仅 299 条巴黎房源记录，可能无法完全覆盖巴黎房源的所有类型，聚类结果的普适性有待提升；
2.  缺乏时间序列数据：仅使用近 12 个月的汇总数据，未包含房源价格与入住率的时间波动信息，无法分析季节性变化对细分市场的影响；
3.  缺失关键运营数据：缺乏房东运营成本、取消订单率、旅客画像等数据，无法更深入地分析细分市场的盈利潜力与客群特征。

**方法层面的不足：**

1.  特征工程深度不足：对地理位置特征仅用于可视化，未进一步提取 "距离市中心距离" 等派生特征；对评论文本（若有）未进行 NLP 分析，错失口碑相关的深度信息；
2.  聚类模型单一性：仅使用 KMeans 与 GMM 两种传统聚类模型，未尝试基于密度的 DBSCAN 模型，对非球形分布数据的捕捉能力有限；
3.  结果验证方式有限：主要依赖轮廓系数与业务经验验证，未采用更多定量指标（如 Calinski-Harabasz 指数）进行交叉验证。

**未来改进方向：**

1.  数据扩充：收集更多巴黎房源样本，引入时间序列数据与旅客画像数据，提升分析结果的普适性与深度；
2.  高级模型尝试：引入 DBSCAN、谱聚类等更先进的聚类模型，对比不同模型的聚类效果，进一步优化细分市场划分；
3.  深度特征工程：利用地理信息系统（GIS）提取房源周边配套特征（如景点、地铁站距离），通过 NLP 分析评论文本挖掘旅客偏好，丰富特征维度；
4.  落地应用探索：基于聚类结果搭建简单的房源分类工具，帮助房东快速定位自身房源市场，实现项目成果的实际落地。

### 7. 小组协作与个人收获

#### 7.1 分工与协作情况

本小组采用 "分工明确、协同推进" 的合作方式，具体如下：

-   GitHub 协作：搭建统一项目仓库，采用 "主分支 + 个人分支" 的管理模式，每位成员在个人分支上完成对应任务，通过 Pull Request 提交代码，由代码负责人审核合并，确保代码质量；未使用 issue 管理，但通过线上会议同步问题与进度；
-   会议与沟通：每周召开 1 次线上会议，同步各模块进展，讨论遇到的技术问题（如聚类数选择、聚类结果的业务解读），通过投票方式解决意见分歧，确保项目按计划推进；
-   文档协作：使用在线文档共同撰写项目报告，由展示与写作负责人统一排版与润色，确保报告风格一致、内容完整；
-   成果汇总：各模块完成后，由建模负责人汇总聚类结果，EDA 负责人提供可视化图表，代码负责人保障项目可复现，最终由展示与写作负责人整合所有成果。

#### 7.2 个人收获（每人 3–5 句话）

**吴生蓉**：通过本次项目，我系统掌握了探索性数据分析的流程与方法，学会了使用 matplotlib、folium 制作专业的数据可视化图表，提升了数据解读与业务洞察能力。在处理房源地理位置数据时，我解决了地图可视化的中文乱码与标记重叠问题，增强了动手实践能力。同时，我也深刻体会到 EDA 是建模的基础，只有充分了解数据，才能确保后续模型的有效性。

**杨妹**：本次项目让我深入理解了无监督聚类算法的原理与应用，熟练掌握了 KMeans 与 GMM 模型的搭建、超参数调优与结果评估方法。我学会了使用轮廓系数选择最优聚类数，能够将技术建模结果与业务场景相结合，撰写具有实际价值的房源画像。通过对比两种模型的表现，我对不同聚类算法的优劣与适用性有了更清晰的认知，提升了机器学习建模的综合能力。

### 8. 附录（可选）

#### 8.1 项目代码结构说明
airbnb-paris-clustering/ # 项目根目录
├── data/
│ └── README.md # 数据说明文档
├── notebooks/ # 笔记本目录，存放EDA与建模过程
│ ├── 01_eda_feature_extraction.ipynb # EDA与特征提取
│ ├── 02_Cluster Modeling.ipynb # 聚类
│ ├── 03_Analysis and Visualization of Clustering Effectiveness.ipynb
│ ├── 04_ Naming and Profiling.ipynb # 市场细分命名与业务画像
│ └── 05_Optional Tasks.ipynb #选做任务
├── src/ # 源代码目录
│ └── main.py # 核心脚本，包含数据预处理与聚类建模
│ └── utils.py # 功能函数
├── reports/ # 报告目录
│ └── 机器学习课程设计项目报告.md # 最终项目报告
├── requirements.txt # 项目依赖库列表
└── .gitignore # Git忽略文件列表（忽略大数据文件、环境配置等）

#### 8.2 关键函数 / 脚本说明

-   `src/main.py`：项目核心脚本，包含`load_and_preprocess_data`（数据加载与预处理）、`run_kmeans_clustering`（KMeans 聚类建模）、`run_gmm_clustering`（GMM 聚类建模）三个核心函数，运行后可直接得到带 KMeans 与 GMM 聚类标签的结果文件；
-   `notebooks/01_eda_feature_extraction.ipynb`：完整记录了从数据读取、EDA、特征工程、预处理、聚类建模到结果分析的全流程，包含详细代码与注释，便于复现与修改；

#### 8.3 运行项目的简要步骤

1.  环境搭建：安装 Python 3.8 及以上版本，执行 `pip install -r requirements.txt` 安装所有依赖库；
2.  数据放置：将 `listings.csv`（巴黎房源数据）放置在 `data/` 目录下；
3.  运行方式 1（Notebook 流程）：打开 `notebooks/01_eda_feature_extraction.ipynb`，按单元格顺序逐行运行，即可完成全流程分析，生成所有可视化图表与聚类结果；
4.  运行方式 2（脚本流程）：进入 `src/` 目录，执行 `python main.py`，即可完成数据预处理、KMeans 与 GMM 聚类建模，结果保存至 `data/result_with_clusters.csv`；
5.  结果查看：聚类结果可在生成的 CSV 文件中查看，可视化图表保存在 `notebooks/figures/` 目录，业务画像保存在 `reports/` 目录。

#### 8.4 项目依赖库列表（requirements.txt）
pandas>=1.5.3
numpy>=1.24.3
scikit-learn>=1.2.2
matplotlib>=3.7.1
folium>=0.14.0
json5>=0.9.14
